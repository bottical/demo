<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ </title>
  <style>
    body {
      margin: 0;
      padding: 1vw;
      font-family: 'Helvetica', 'Arial', sans-serif;
      background-color: #f4f6f8;
      color: #333;
      box-sizing: border-box;
      text-align: center;
    }

    h2, h3 {
      font-size: 6vw;
      margin-bottom: 4vw;
    }

    input[type="text"] {
      width: 80%;
      padding: 3vw;
      margin: 2vw 0;
      font-size: 4.5vw;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    .btn {
      display: inline-block;
      margin: 3vw 2vw;
      padding: 3vw 5vw;
      font-size: 4.5vw;
      background: #2196f3;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: background 0.3s ease;
    }

    .btn:hover {
      background: #1976d2;
    }

    #status {
      font-size: 4vw;
      color: #555;
      margin-top: 2vw;
    }

    ul#results {
      list-style: none;
      padding: 0;
      margin-top: 4vw;
      font-size: 4.5vw;
    }

ul#results li {
  display: flex;
  justify-content: space-between; /* å·¦å³ã«åˆ†ã‘ã‚‹ */
  align-items: center;
  background: #fff;
  margin: 2vw auto;
  padding: 3vw;
  width: 90%;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  font-size: 4.5vw;
}


    @media (min-width: 600px) {
      h2, h3 {
        font-size: 32px;
      }
      input[type="text"] {
        font-size: 20px;
      }
      .btn {
        font-size: 18px;
      }
      ul#results li {
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
  <h2>åå‰ã¨ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›</h2>
  <input type="text" id="name" placeholder="åå‰"/><br>
  <input type="text" id="word" placeholder="ãƒ¯ãƒ¼ãƒ‰"/><br>
  <button id="submitBtn" class="btn">é€ä¿¡</button>

  <p id="status"></p>

  <hr style="margin: 5vw 0;" />

  <button id="showResultsBtn" class="btn">çµæœç™ºè¡¨</button>
  <button id="resetBtn" class="btn">ãƒªã‚»ãƒƒãƒˆ</button>

  <h3>å…¨å“¡ã®å…¥åŠ›ä¸€è¦§</h3>
  <ul id="results"></ul>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      deleteDoc,
      doc,
      getDocs,
      query,
      orderBy
    } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAWZRdhMJgW23A4L-CWZPn30iMoZNCZzjc",
      authDomain: "input-3b872.firebaseapp.com",
      projectId: "input-3b872",
      storageBucket: "input-3b872.appspot.com",
      messagingSenderId: "8756337072",
      appId: "1:8756337072:web:d162fc4f3b5ec53af0de75"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const entriesRef = collection(db, "entries");

document.getElementById("submitBtn").addEventListener("click", async () => {
  navigator.vibrate?.(100); // ğŸ“³ ãƒã‚¤ãƒ–è¿½åŠ ï¼ˆå¯¾å¿œç«¯æœ«ã®ã¿ï¼‰

  const name = document.getElementById("name").value.trim();
  const word = document.getElementById("word").value.trim();
  const status = document.getElementById("status");

  if (!name || !word) {
    status.textContent = "åå‰ã¨ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
    return;
  }

  try {
    await addDoc(entriesRef, {
      name,
      word,
      createdAt: new Date()
    });
    status.textContent = "é€ä¿¡ã—ã¾ã—ãŸï¼";
    // åå‰ã¯ä¿æŒã—ã€ãƒ¯ãƒ¼ãƒ‰ã ã‘ãƒªã‚»ãƒƒãƒˆ
    document.getElementById("word").value = "";
  } catch (e) {
    console.error("é€ä¿¡ã‚¨ãƒ©ãƒ¼:", e);
    status.textContent = "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
  }
});

document.getElementById("showResultsBtn").addEventListener("click", async () => {
  navigator.vibrate?.(50);
  const resultsList = document.getElementById("results");
  resultsList.innerHTML = "";

  try {
    const snapshot = await getDocs(query(entriesRef, orderBy("createdAt")));
    snapshot.forEach(docSnap => {
      const data = docSnap.data();
      const id = docSnap.id;

      const li = document.createElement("li");
      li.textContent = `${data.name}ï¼š${data.word}`;

      // å‰Šé™¤ãƒœã‚¿ãƒ³ã®è¿½åŠ 
      const delBtn = document.createElement("button");
      delBtn.textContent = "âœ•å‰Šé™¤";
      delBtn.style.marginLeft = "10px";
      delBtn.style.fontSize = "4vw";
      delBtn.style.padding = "1vw 2vw";
      delBtn.style.borderRadius = "5px";
      delBtn.style.background = "#f44336";
      delBtn.style.color = "white";
      delBtn.style.border = "none";
      delBtn.style.cursor = "pointer";

      delBtn.onclick = async () => {
        const ok = confirm("ã“ã®æŠ•ç¨¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ");
        if (!ok) return;
        try {
          await deleteDoc(doc(db, "entries", id));
          li.remove(); // å³åº§ã«UIã‹ã‚‰ã‚‚å‰Šé™¤
        } catch (e) {
          alert("å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ");
          console.error(e);
        }
      };

      li.appendChild(delBtn);
      resultsList.appendChild(li);
    });
  } catch (e) {
    console.error("è¡¨ç¤ºã‚¨ãƒ©ãƒ¼:", e);
    document.getElementById("status").textContent = "çµæœè¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
  }
});

document.getElementById("resetBtn").addEventListener("click", async () => {
  navigator.vibrate?.(100); // ğŸ“³ ãƒã‚¤ãƒ–

  const confirmReset = confirm("ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ");
  if (!confirmReset) return;

  try {
    const snapshot = await getDocs(entriesRef);
    const deletions = snapshot.docs.map(docSnap => deleteDoc(doc(db, "entries", docSnap.id)));
    await Promise.all(deletions);
    document.getElementById("status").textContent = "ãƒªã‚»ãƒƒãƒˆå®Œäº†ã—ã¾ã—ãŸã€‚";
    document.getElementById("results").innerHTML = "";
  } catch (e) {
    console.error("ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:", e);
    document.getElementById("status").textContent = "ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
  }
});
  </script>
</body>
</html>
