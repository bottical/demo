<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ãƒã‚¦ãƒ³ã‚¹ã‚ªãƒ•ã€€6ãƒ©ãƒ³ãƒ€ãƒ </title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --ink:#e5e7eb; --muted:#94a3b8; --accent:#60a5fa; --grid-cols:12; --grid-rows:20;
    }
    *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
    html,body{height:100%;}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans JP", sans-serif;
      padding:16px;
    }
    .wrap{
      width:min(94vw, 94vh); /* æ­£æ–¹å½¢ã«è¿‘ã¥ã‘ã‚‹ï¼šã‚¹ãƒãƒ›ã§è¦‹ã‚„ã™ã„ */
      max-width:700px;
      aspect-ratio: 3/4; /* ç›¤é¢ã®ç¸¦é•·æ¯”ç‡ */
      background:var(--card);
      border:1px solid #1f2937;
      border-radius:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      padding:10px;
      display:grid;
      grid-template-columns: repeat(var(--grid-cols), 1fr);
      grid-template-rows: repeat(var(--grid-rows), 1fr);
      gap: 6px;
      user-select:none;
      touch-action: manipulation; /* ã‚¿ãƒƒãƒ—ã®é…å»¶æŠ‘åˆ¶ */
      position: relative;
    }
    .dot{
      width:100%;
      aspect-ratio:1/1;
      border-radius:50%;
      /* å½±ã§ç«‹ä½“æ„Ÿ */
      box-shadow: inset 0 2px 6px rgba(255,255,255,.12), 0 4px 10px rgba(0,0,0,.35);
      transition: transform .12s ease;
    }
    .dot:active{ transform: scale(.96); }

    .ui{
      display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap;
      color:var(--muted); font-size:.95rem;
    }
    button{
      appearance:none; border:none; cursor:pointer;
      background:linear-gradient(180deg, #2563eb, #1d4ed8);
      color:white; padding:10px 16px; border-radius:12px; font-weight:600;
      box-shadow: 0 6px 16px rgba(37,99,235,.35);
    }
    button:active{ transform: translateY(1px); }
    .hint{ font-size:.85rem; color:var(--muted); }
  </style>
</head>
<body>
  <div class="wrap" id="board" title="ã‚¿ãƒƒãƒ—ã§å†ç”Ÿæˆã§ãã¾ã™"></div>
  <div class="ui">
    <button id="reroll">ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ</button>
    <div class="hint">ğŸ‘† ç”»é¢ã‚¿ãƒƒãƒ—ã§ã‚‚å†ç”Ÿæˆ</div>
  </div>

  <script>
    // è¨­å®š
    const COLS = 12;   // ã‚°ãƒªãƒƒãƒ‰åˆ—
    const ROWS = 20;   // ã‚°ãƒªãƒƒãƒ‰è¡Œ
    const COUNT = 6;   // ä¸¸ã®æ•°ï¼ˆï¼6ãƒŸãƒï¼‰
    const COLORS = [
      ["#34d399","#065f46"], // teal/green
      ["#60a5fa","#1e3a8a"], // blue
      ["#f472b6","#831843"], // pink
      ["#f59e0b","#78350f"], // amber
      ["#a78bfa","#4c1d95"], // violet
      ["#f87171","#7f1d1d"], // red
    ];

    const board = document.getElementById('board');
    const btn = document.getElementById('reroll');

    // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    function rnd(n){ return Math.floor(Math.random()*n); }
    function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=rnd(i+1); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }

    // é€£çµ6ãƒã‚¹ï¼ˆä¸Šä¸‹å·¦å³ï¼‰ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆ
    function randomConnectedPositions(count=COUNT){
      // æœ‰åŠ¹ç¯„å›²å†…ã§ã‚„ã‚„ä¸­å¤®å¯„ã‚Šã«é–‹å§‹
      let x = 2 + rnd(COLS-4);
      let y = 2 + rnd(ROWS-4);
      const cells = new Set([`${x},${y}`]);

      const dirs = [[1,0],[-1,0],[0,1],[0,-1]];

      let guard = 0;
      while(cells.size < count && guard < 5000){
        guard++;
        // æ—¢å­˜ã‚»ãƒ«ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤é¸ã¶
        const list = Array.from(cells).map(s => s.split(',').map(Number));
        const [cx, cy] = list[rnd(list.length)];
        // ãƒ©ãƒ³ãƒ€ãƒ æ–¹å‘
        const [dx, dy] = dirs[rnd(dirs.length)];
        let nx = cx + dx;
        let ny = cy + dy;
        // ç›¤é¢å¤–ã¯å†è©¦è¡Œ
        if(nx<0||nx>=COLS||ny<0||ny>=ROWS) continue;
        const key = `${nx},${ny}`;
        if(!cells.has(key)){
          cells.add(key);
        }
      }
      // ä¿é™ºï¼šä¸‡ä¸€è¶³ã‚Šãªã‘ã‚Œã°å†å¸°
      if(cells.size < count) return randomConnectedPositions(count);
      return Array.from(cells).map(s => s.split(',').map(Number));
    }

    // æç”»
    function render(){
      board.innerHTML = "";
      // ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒã‚’é¸æŠ
      const [fill, dark] = COLORS[rnd(COLORS.length)];
      const accents = shuffle([
        "#ffffff", // ç™½ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        fill,      // ãƒ¡ã‚¤ãƒ³
        dark       // æ¿ƒã„å½±
      ]);

      const positions = randomConnectedPositions(COUNT);

      // å„ä¸¸ã‚’é…ç½®
      positions.forEach(([x,y], idx) => {
        const d = document.createElement('div');
        d.className = "dot";
        d.style.gridColumn = (x+1);
        d.style.gridRow = (y+1);
        // ã‚°ãƒ©ãƒ‡ã¨ç¸
        d.style.background = `radial-gradient(circle at 35% 30%, ${accents[0]}, ${fill} 35%, ${dark} 100%)`;
        d.style.border = "1px solid rgba(0,0,0,.35)";
        board.appendChild(d);
      });
    }

    // åˆæœŸåŒ–ï¼†ã‚¤ãƒ™ãƒ³ãƒˆ
    function init(){
      // CSSã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¡Œåˆ—ã‚’åæ˜ ï¼ˆä¸‡ä¸€å¤‰æ›´ã—ãŸã„å ´åˆã«å‚™ãˆã¦ï¼‰
      document.documentElement.style.setProperty('--grid-cols', COLS);
      document.documentElement.style.setProperty('--grid-rows', ROWS);
      render();
    }

    btn.addEventListener('click', render);
    // ãƒœãƒ¼ãƒ‰ã‚¿ãƒƒãƒ—ã§ã‚‚å†ç”Ÿæˆ
    board.addEventListener('click', render, {passive:true});
    board.addEventListener('touchend', (e)=>{ e.preventDefault(); render(); }, {passive:false});

    // ç”»é¢å›è»¢ç­‰ã§ãƒªãƒ•ãƒ­ãƒ¼ã—ã¦ã‚‚OKï¼ˆã‚µã‚¤ã‚ºã¯CSSä¾å­˜ï¼‰
    window.addEventListener('resize', ()=>{/* no-op */});

    init();
  </script>
</body>
</html>
